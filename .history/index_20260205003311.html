<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smart Phone Advisor</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { background-color: #f0f2f5; font-family: 'Segoe UI', sans-serif; min-height: 100vh; display: flex; align-items: center; justify-content: center; }
        .card { width: 100%; max-width: 800px; padding: 30px; border-radius: 15px; box-shadow: 0 8px 30px rgba(0,0,0,0.12); border: none; }
        .btn-primary { background: linear-gradient(45deg, #2563eb, #1e40af); border: none; padding: 12px; font-weight: 600; }
        .table th { background-color: #f8f9fa; text-transform: uppercase; font-size: 0.85rem; color: #6c757d; }
        .vs-badge { background-color: #ffca2c; color: #000; padding: 5px 10px; border-radius: 20px; font-weight: bold; font-size: 0.8rem; }
    </style>
</head>
<body>

    <div class="card">
        <div class="text-center mb-4">
            <h2 class="fw-bold mb-2">üì± Samsung Phone Advisor</h2>
            <p class="text-muted">Search single (e.g., "Samsung S23") or Compare (e.g., "S22 vs S23")</p>
        </div>
        
        <div class="input-group mb-3">
            <input type="text" id="question" class="form-control form-control-lg" placeholder="Enter phone model..." onkeypress="handleEnter(event)">
            <button class="btn btn-primary px-4" onclick="askQuestion()">Search</button>
        </div>

        <div id="loading" class="text-center py-4" style="display: none;">
            <div class="spinner-border text-primary" role="status"></div>
            <p class="mt-2 text-muted">Analyzing request...</p>
        </div>

        <div id="result" class="mt-4"></div>
    </div>

    <script>
        function handleEnter(e) {
            if (e.key === "Enter") askQuestion();
        }

        async function askQuestion() {
            const question = document.getElementById("question").value.trim();
            const resultDiv = document.getElementById("result");
            const loadingDiv = document.getElementById("loading");

            if (!question) return alert("Please enter a model name!");

            resultDiv.innerHTML = "";
            loadingDiv.style.display = "block";

            try {
                const response = await fetch(`http://127.0.0.1:8000/ask?question=${encodeURIComponent(question)}`, {
                    method: "POST"
                });
                const data = await response.json();
                loadingDiv.style.display = "none";

                // Scenario 1: Comparison (VS)
                if (data.mode === "comparison") {
                    const p1 = data.phone1;
                    const p2 = data.phone2;
                    
                    resultDiv.innerHTML = `
                        <div class="table-responsive">
                            <h5 class="text-center mb-3">‚öîÔ∏è Comparison Result</h5>
                            <table class="table table-bordered text-center align-middle">
                                <thead class="table-dark">
                                    <tr>
                                        <th style="width: 20%">Feature</th>
                                        <th style="width: 40%">${p1.model || "Phone 1"}</th>
                                        <th style="width: 40%">${p2.model || "Phone 2"}</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    ${generateRow("Release", p1.release_date, p2.release_date)}
                                    ${generateRow("Display", p1.display, p2.display)}
                                    ${generateRow("Battery", p1.battery, p2.battery)}
                                    ${generateRow("Camera", p1.camera, p2.camera)}
                                    ${generateRow("RAM", p1.ram, p2.ram)}
                                    ${generateRow("Storage", p1.storage, p2.storage)}
                                    ${generateRow("Price", "$" + p1.price, "$" + p2.price)}
                                </tbody>
                            </table>
                        </div>`;
                }
                
                // Scenario 2: Single Phone
                else if (data.mode === "single") {
                    const p = data.data;
                    resultDiv.innerHTML = `
                        <div class="card bg-light p-3">
                            <h4 class="text-center text-primary mb-3">${p.model}</h4>
                            <table class="table table-striped">
                                <tbody>
                                    <tr><th>üìÖ Release</th><td>${p.release_date} (${p.release_year})</td></tr>
                                    <tr><th>üì± Display</th><td>${p.display}</td></tr>
                                    <tr><th>üîã Battery</th><td>${p.battery}</td></tr>
                                    <tr><th>üì∏ Camera</th><td>${p.camera}</td></tr>
                                    <tr><th>üíæ RAM</th><td>${p.ram}</td></tr>
                                    <tr><th>üíΩ Storage</th><td>${p.storage}</td></tr>
                                    <tr><th>üí∞ Price</th><td>$${p.price}</td></tr>
                                </tbody>
                            </table>
                        </div>`;
                } 
                
                // Scenario 3: Not Found
                else {
                    resultDiv.innerHTML = `<div class="alert alert-warning text-center">‚ùå No data found for "${question}"</div>`;
                }

            } catch (error) {
                loadingDiv.style.display = "none";
                resultDiv.innerHTML = `<div class="alert alert-danger text-center">Server Error. Check terminal!</div>`;
            }
        }

        function generateRow(label, val1, val2) {
            // ‡¶Ø‡¶¶‡¶ø ‡¶°‡¶æ‡¶ü‡¶æ ‡¶®‡¶æ ‡¶•‡¶æ‡¶ï‡ßá
            val1 = val1 || "-";
            val2 = val2 || "-";
            // ‡¶Ø‡ßá‡¶ü‡¶æ‡¶∞ ‡¶≠‡ßç‡¶Ø‡¶æ‡¶≤‡ßÅ ‡¶≠‡¶æ‡¶≤‡ßã ‡¶∏‡ßá‡¶ü‡¶æ ‡¶π‡¶æ‡¶á‡¶≤‡¶æ‡¶á‡¶ü ‡¶ï‡¶∞‡¶æ ‡¶Ø‡ßá‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßá (‡¶≠‡¶¨‡¶ø‡¶∑‡ßç‡¶Ø‡¶§‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø), ‡¶è‡¶ñ‡¶® ‡¶∏‡¶ø‡¶Æ‡ßç‡¶™‡¶≤ ‡¶∞‡¶æ‡¶ñ‡¶õ‡¶ø
            return `
                <tr>
                    <td class="fw-bold bg-light">${label}</td>
                    <td>${val1}</td>
                    <td>${val2}</td>
                </tr>
            `;
        }
    </script>
</body>
</html>